# Logistic map

Автор: Hermitian Operator  

Санкт-Петербург, 2025

---

## Правила выполнения работы

1. Теоретические задания требуют развёрнутых ответов с математическими выкладками и пояснениями. Односложные ответы («да/нет», «возможно») считаются некорректными.  

2. Работу можно выполнять на любом языке программирования. Рекомендуется использование Python с библиотеками `numpy` и `matplotlib`.  

3. Работа выполняется и сдаётся в электронном виде. Допускается использование Jupyter Notebook и/или LaTeX с вставками кода. Кроме того, весь код необходимо продублировать в облачной системе контроля версий, например, GitHub или GitLab.

---

## Introduction

> “We live on an island surrounded by  
> a sea of ignorance. As our island of  
> knowledge grows, so does the shore of our  
> ignorance.”

На сегодняшний день существует большое число реальных систем из совершенно разных областей, которые можно описывать, рассматривая их как динамические системы. Не вдаваясь в подробности, систему можно назвать динамической, если для её описания можно ввести динамические переменные – величины, меняющиеся под действием некоего закона (оператора эволюции), по которому система переходит из одного состояния в другое.

В качестве динамических переменных в таких системах могут служить совершенно разные величины, например: объём, температура, давление, концентрация, населённость уровней или численность популяций. Именно из-за столь широкой применимости методов анализа динамических систем этот междисциплинарный подход снискал большое внимание и по сей день открывает новые возможности.

В данной лабораторной работе мы рассмотрим один из способов задания эволюции: с использованием точечных отображений. Точечные (дискретные) отображения задают закон эволюции с помощью простых итерационных формул. В данной лабораторной работе предлагается на нескольких примерах изучить основные свойства точечных отображений.

---

## Easy level

Ключевые слова:  
Динамическая система, оператор эволюции, точечное отображение, логистическое отображение.

### Точечное отображение и логистическая карта

Точечное отображение — это математическая модель динамической системы с дискретным временем, заданная рекуррентным соотношением:
  
$\vec{x}_{n+1} = \vec{f}(\vec{x}_n)$,

где $\vec{x}_n$ — вектор состояния в момент $n$, а $\vec{f}$ — отображение, определяющее переход к следующему состоянию.

В качестве общего задания предлагается рассмотреть одномерное логистическое отображение:

$x_{n+1} = r x_n (1 - x_n)$.

Это одно из самых известных отображений, которое может демонстрировать хаотическую динамику и используется в качестве модели для скорости изменения численности популяции с учётом борьбы особей за ограниченные ресурсы или место обитания. В этом случае $x_n$ — это нормированная численность популяции некоторого вида в какой-то момент времени (например, в какой-то год), а $x_{n+1}$ — это численность того же вида в следующий год.

Значение $x$ меняется в пределах от $0$ до $1$, а в качестве управляющего параметра выступает $r$ — величина, меняющаяся от $0$ до $4$, характеризующая скорость роста популяции («рождаемость минус смертность»).

#### Easy 1

Докажите, что при любых $n \in \mathbb{N}$ и $r \in [0; 1]$ выполняется

$$
0 < x_0 < 1 \;\Rightarrow\; 0 < x_n < 1.
$$

---

### Влияние параметра \( r \) и варианты отображения \( g(x_n) \)

#### Easy 2

Сделайте вывод: как параметр $r$ влияет на поведение функции зависимости $x_n$ от $x_{n-1}$? Постройте эту функцию для нескольких различных значений $r$.

Пусть $N = \mathrm{ISU} \pmod 5$. Определим варианты лабораторной работы (отображение $g$):

$$
g(x_{n+1}) =
\begin{cases}
r x_n (1 - x_n)(2 + x_n), & r \in \left[0; \dfrac{27}{2(7\sqrt{7} - 10)}\right],\; N = 0, \\
r x_n \left(1 - x_n^2\right), & r \in \left[0; \dfrac{3\sqrt{3}}{2}\right],\; N = 1, \\
r x_n (1 - x_n)^2, & r \in \left[0; \dfrac{27}{4}\right],\; N = 2, \\
r x_n (1 - x_n)(3 - x_n), & r \in \left[0; \dfrac{27}{2(7\sqrt{7} - 10)}\right],\; N = 3, \\
r x_n (1 - x_n)(2 - x_n), & r \in \left[0; \dfrac{3\sqrt{3}}{2}\right],\; N = 4.
\end{cases}
$$

(Здесь в каждом варианте речь идёт об отображении вида $x_{n+1} = g(x_n)$.)

#### Easy 3

Для заданной вариантом функции $g(x_n)$:

1. Постройте графики зависимости $x_n$ от $x_{n-1}$ для нескольких различных значений $r$.  
2. Сделайте вывод о сходстве или различии поведения логистического отображения и точечного отображения из вашего варианта. Предположите, чем могут быть вызваны сходства/различия.

---

## Normal level

Ключевые слова:  
Неподвижная точка, подпоследовательность, монотонность, сходимость.

### Неподвижные точки

Важными для понимания свойств точечных отображений являются понятия неподвижных точек разной кратности, циклы, их устойчивость.

Неподвижная точка $x^*$ переходит сама в себя под действием отображения, то есть удовлетворяет соотношению

$$
x^* = f(x^*).
$$

#### Normal 1

1. Найдите все неподвижные точки логистического отображения $x_{n+1} = r x_n (1 - x_n)$.  
2. При каких $r$ отображение имеет одну неподвижную точку? Несколько?  
3. Какое максимальное количество неподвижных точек может иметь логистическое отображение? Почему?

### Монотонность и сходимость последовательности \( \{x_n\} \)

#### Normal 2

Докажите, что при $x_0 \in (0; 1)$ и $r \in (0; 1]$ последовательность $\{x_n\}$, заданная логистическим отображением, монотонно убывает. Существует ли предел у данной последовательности при $r \in (0; 1]$? Докажите. Покажите графически.

#### Normal 3

Пусть $r \in (2; 3)$, $x_{2n} > x^*$, $x_{2n+1} < x^*$. Что вы можете сказать о монотонности подпоследовательностей $\{x_{2n}\}$, $\{x_{2n+1}\}$? Докажите. Проверьте графически.  

(Аналогично, здесь идёт речь о логистическом отображении.)

Известно, что при $x_0 \in (0; 1)$, $r \in (1; 3]$ выполняется

$$
\lim_{n \to \infty} x_n = x^*.
$$

### Отображение \( g(x_n) \) на Normal-уровне

#### Normal 4

Для отображения $g(x_n)$, заданного вариантом:

1. Аналитически найдите неподвижную точку (или точки).  
2. Найдите или оцените диапазон параметра $r$, при котором последовательность монотонно сходится к нулю.  
3. Постройте графики зависимости $x_n$ от $n$ для нескольких различных значений параметра $r$.

---

## Hard level

Ключевые слова:  
Неподвижная точка кратности $m$, цикл порядка $m$, лестница Ламерея.

### Неподвижные точки кратности \( m \) и циклы

Итак, мы посмотрели на поведение последовательности при $r \in [0; 3]$. Для дальнейшего исследования введём необходимые понятия.

Если, стартуя из точки $x^*_1$, в результате $m$-кратного выполнения отображения $f(x)$ получается та же самая точка $x^*_1$, говорят, что $x^*_1$ — неподвижная точка кратности $m$. Формально:

$$
x^*_1 = \underbrace{f(f(\dots f(x^*_1) \dots))}_{m\ \text{раз}} = f^m(x^*_1).
$$

Тогда циклом порядка $m$ называют последовательность:

$$
x^*_2 = f(x^*_1),\quad
x^*_3 = f(x^*_2),\quad \dots,\quad
x^*_{m+1} = f(x^*_m) = x^*_1,
$$

причём $\forall i, j\; x^*_i \ne x^*_j$.

Каждая точка данной последовательности является неподвижной точкой кратности $m$.

#### Hard 1

1. Положим $r_\infty \approx 3.5699456\ldots$. Как изменяется длина цикла при $r \in (3; r_\infty)$?  
2. Для $r \in (3; r_\infty)$ экспериментально установите, какие ограничения действуют на $m$. (Здесь имеется в виду не ограниченность сверху или снизу, а закономерность изменения длины цикла $m$.)

### Лестница Ламерея

Один из методов графического отображения сходимости к неподвижной точке – построение лестницы Ламерея. Алгоритм её построения можно сформулировать следующим образом:

1. От начальной точки $(x_0; 0)$ следует двигаться вертикально к линии отображения. Записывается точка пересечения с линией $(x_0; x_1)$, где $x_1$ получена в результате итерации $x_1 = f(x_0)$.  
2. От точки $(x_0; x_1)$ нужно переходить по горизонтали к точке $(x_1; x_1)$.  
3. От точки $(x_1; x_1)$ снова строится вертикальная линия до пересечения с кривой отображения, т.е. к точке $(x_1; x_2)$, где $x_2$ получена в результате итерации $x_2 = f(x_1)$, и повторяются пункты, начиная со второго, переходя к следующим членам последовательности.

(На соответствующем рисунке по оси абсцисс откладывается $x_n$, по оси ординат — $x_{n+1}$; прямая $x_{n+1} = x_n$ и кривая $x_{n+1} = f(x_n)$, а также точки $(x_0, 0)$, $(x_0, x_1)$, $(x_1, x_1)$, $(x_1, x_2)$ и т.д.)

#### Hard 2

1. Напишите функцию, которая для заданного параметра $r$ строит лестницу Ламерея.  
2. Сделайте выводы: как выглядят циклы различных порядков на графике?

#### Hard 3

Исследуйте: как изменяется длина цикла, заданного вариантом отображения $g(x_n)$, с изменением параметра $r$? Постройте соответствующие графики. Есть ли сходства с логистическим отображением?

---

## Expert level

Ключевые слова:  
Устойчивость, асимптотическая устойчивость, чувствительность к начальным условиям, динамический (детерминированный) хаос, бифуркация, точка бифуркации, бифуркационная диаграмма, самоподобие, масштабная инвариантность.

### Устойчивость и асимптотическая устойчивость

Неподвижная точка $x^*$ называется устойчивой, если

$$
\forall \varepsilon > 0\ \exists \delta > 0:\ |x_0 - x^*| < \delta \Rightarrow |x_n - x^*| < \varepsilon\ \forall n.
$$

Неподвижная точка $x^*$ называется асимптотически устойчивой, если она устойчива и

$$
\exists \delta_0 > 0:\ |x_0 - x^*| < \delta_0 \Rightarrow x_n \xrightarrow[n \to \infty]{} x^*.
$$

То есть устойчивость говорит нам о том, что есть «коридор» вокруг $x^*$ и $x_n$ находится в этом коридоре при любых $n$. А асимптотическая устойчивость добавляет к этому условию сходимость.

Также говорят, что решение устойчиво по Ляпунову, асимптотически устойчиво по Ляпунову.

#### Expert 1

Следует ли асимптотическая устойчивость $x^*$ из условия

$$
\exists \delta_0 > 0:\ |x_0 - x^*| < \delta_0 \Rightarrow x_n \xrightarrow[n \to \infty]{} x^* \; ?
$$

Обоснуйте свой ответ.

#### Expert 2

Докажите или опровергните утверждение.

При $r \in (0; 1)$ неподвижная точка $x^* = 0$ является устойчивой. Является ли она асимптотически устойчивой?

#### Expert 3

Докажите, что точка $x^* = 0$ при $r \in (2; 3)$ является неустойчивой.

Передадим привет `Sakura` и в финальной главе поговорим о хаосе.

### Чувствительность к начальным условиям

Система проявляет чувствительность к начальным условиям, если

$$
\exists \delta > 0\ \forall x_0\ \forall \varepsilon > 0\ \exists y_0:\ |x_0 - y_0| < \varepsilon \wedge |x_n - y_n| > \delta.
$$

NB: $\delta$ фиксировано один раз для всей системы, иначе, если бы $\delta$ зависело от $x_0$ или $\varepsilon$, его можно было бы «подгонять» под конкретную пару траекторий $x_n$, $y_n$.

NB: при $r = 4$ система, заданная логистическим отображением, чувствительна к начальным условиям.

#### Expert 4

Напишите функцию, которая для заданных $x_0$, $y_0 = x_0 + \varepsilon$, $r$ строит две траектории лестницы Ламерея на одном графике. Постройте этот график для $r = 4$. Как можно интерпретировать результаты?

Иногда сильное расхождение траекторий при близких начальных условиях также называют эффектом бабочки.

В контексте точечного отображения установившимся режимом называют такое поведение последовательности $\{x_n\}_{n=0}^\infty$, при котором, начиная с некоторого номера $N$, все последующие значения либо:

1. стремятся к фиксированной точке $x^*$;  
2. попадают в цикл кратности $p$;  
3. проявляют поведение, при котором траектория не сходится ни к точке, ни к конечному циклу, но при этом остаётся ограниченной и чувствительной к начальным условиям.

### Бифуркации и бифуркационная диаграмма

Бифуркацией называют смену установившегося режима поведения системы, как правило, вследствие изменения управляющего параметра. Момент такой смены называют точкой бифуркации.

Отметим, что бифуркациями считаются не только переходы между режимами 1–3, но и изменения кратности цикла.

Одним из способов исследования отображений является построение бифуркационной диаграммы. Такая диаграмма демонстрирует, как меняется поведение системы в зависимости от управляющего параметра.

Для построения бифуркационной диаграммы рекомендуется воспользоваться следующим алгоритмом:

1. Стартуя из произвольной начальной точки $x_0$ и выбрав какое-то $r$, в результате итераций получаем значения $x_n = \{x_1, x_2, x_3, \dots\}$. Число итераций выбирается достаточно большим (порядка тысячи).  
2. Из всего набора $x_n$ оставляется несколько последних, например, $20$–$100$ значений. Эти значения записываются вместе со значением $r$.  
3. То же самое проделывается и для других случайных точек и того же $r$.  
4. Пункты 1 и 2 повторяются для другого значения $r$.  
5. Записанные числа отображаются в зависимости от $r$. То есть на экране должны появиться все точки, которые были записаны при данном $r$.

#### Expert 5

1. Постройте бифуркационную диаграмму логистического отображения.  
2. Проанализируйте: как интерпретировать полученный график?  
3. Где на диаграмме находится $r_\infty$? Как ведёт себя система до $r_\infty$? После?

Бифуркационное дерево в окрестности точки перехода к хаосу обладает самоподобной структурой, которая воспроизводится во всё более мелких масштабах. Это свойство называется масштабной инвариантностью. При увеличении масштаба бифуркационной диаграммы в окрестности критической точки по горизонтальной оси в $\delta = 4.669209\ldots$ (универсальная постоянная Фейгенбаума), а по вертикальной оси – в $\alpha = -2.5029$ (вторая универсальная постоянная Фейгенбаума; знак минус означает изменение ориентации координатных осей), мы получим рисунки, совпадающие с исходной бифуркационной диаграммой.

#### Expert 6

С помощью увеличения фрагмента около $r \approx 3.83$ визуализируйте фрактальную структуру (самоподобие) бифуркационной диаграммы.

Интересно, что при $r > r_\infty$ на бифуркационной диаграмме логистического отображения возникают так называемые «окна периодичности» – области с ярко выраженными циклами конечной длины.

#### Expert 7

Приближённо найдите значения $r$, при которых возникают циклы с периодом $3$, $5$, $6$. Отобразите область(-и) бифуркационной диаграммы с соответствующими окнами периодичности.

### Динамический хаос

Динамический хаос (также детерминированный хаос) — явление в теории динамических систем, при котором поведение нелинейной системы выглядит случайным, несмотря на то, что оно определяется детерминистическими законами.

Причиной появления хаоса является чувствительность к начальным условиям (неустойчивость) и параметрам: малое изменение начального условия со временем приводит к сколь угодно большим изменениям динамики системы.

#### Expert (бонус)

С помощью внешних источников исследуйте: как связано наличие цикла с периодом $3$ с хаотичностью системы?

### Expert: отображение \( g(x_n) \)

Для заданного вариантом отображения $g(x_n)$:

1. Численно или аналитически найдите верхнюю и нижнюю границы параметра $r$, при котором точка $x^* = 0$ является устойчивой / неустойчивой.  
2. Постройте бифуркационную диаграмму. Отметьте сходства или различия с диаграммой логистического отображения.  
3. Визуализируйте окна периодичности, если они есть.

---

## Практические применения

Хаотические системы используются для:

- генерации псевдослучайных чисел в условиях ограниченных вычислительных ресурсов, что можно использовать для инициализации весов нейросетей;  
- моделирования сложных временных рядов с целью синтеза обучающих данных для обучения моделей решению задач прогнозирования;  
- анализа устойчивости нейросетевых моделей к adversarial perturbations;  
- создания хаотических нейронных сетей.

---

## Рекомендуемая литература

1. С. П. Кузнецов, *Динамический хаос*.  
2. Ю. Н. Прошин, М. А. Шакиров, *Моделирование и визуализация нелинейных динамических систем. Часть 1. Точечные отображения*, учеб. пособие, КФУ, Казань, 2019.  
3. А. А. Килин, *Введение в теорию точечных отображений. Динамический хаос*, учеб. пособие, Ижевск, 2021.

(Для тех, кто желает углубиться в теорию точечных отображений и теорию хаоса.)
